{% extends "users/base.html" %} {% load static %} {% block title %}
<title>DashBoard</title>
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
  crossorigin="anonymous"
/>
<link
  rel="stylesheet"
  type="text/css"
  href="{% static '/css/linkpage.css' %}"
/>
{% endblock title %} {% block content %}
<nav class="navbar navbar-expand-lg navbar-custom p-3 bg-dark text-white">
  <a class="navbar-brand pl-3" href="/">
    <img
      class="bg-dark"
      src="{% static 'images/logo.png' %}"
      style="width: 100px"
      alt="On1i image"
    />
  </a>
  <button
    class="navbar-toggler text-white"
    type="button"
    data-toggle="collapse"
    data-target="#navbarNav"
    aria-controls="navbarNav"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon bg-secondary"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav ml-auto">
      {% if user_name %}
      <li class="nav-item pl-2 text-center">
        <a class="nav-link text-white" href="{% url 'home-page' %}"
          >Home Page</a
        >
      </li>
      <li class="nav-item pl-2 text-center">
        <a class="nav-link text-white" href="{% url 'link-view' %}"
          >Link Page</a
        >
      </li>
      <li class="nav-item pl-2 text-center">
        <a class="nav-link text-white" href="{% url 'logout' %}">Logout</a>
      </li>
      {% endif %}
    </ul>
  </div>
</nav>

<h1 class="text-center my-3">Dashboard - Doubtnut</h1>
<div class="canvas-container mb-3">
  <canvas id="myChart" width="400" height="400"></canvas>
  <h1 id="view-error"></h1>
</div>

<!-- Footer -->
<footer id="ftr" class="text-center bg-dark text-white mt-auto pt-2">
  <div class="container">
    <div class="social-profiles mb-3">
      <a class="facebook" href="#">
        <img src="https://img.icons8.com/fluency/36/000000/facebook-new.png" />
      </a>
      <a class="twitter" href=" https://www.facebook.com/on1iapp">
        <img src="https://img.icons8.com/fluency/36/000000/twitter.png" />
      </a>
      <a class="instagram" href=" https://www.instagram.com/on1iapp/">
        <img
          src="https://img.icons8.com/color/36/000000/instagram-new--v1.png"
        />
      </a>
    </div>
    <p>
      &copy;
      <script>
        document.write(new Date().getFullYear());
      </script>
      On1i
    </p>
  </div>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
  function getRandomColor() {
    var letters = "0123456789ABCDEF";
    var color = "#";
    for (var i = 0; i < 6; i++) {
      color += letters[Math.floor(Math.random() * 16)];
    }
    return color;
  }

  // Generate an array of random colors
  function generateRandomColors(numColors) {
    var colors = [];
    for (var i = 0; i < numColors; i++) {
      colors.push(getRandomColor());
    }
    return colors;
  }

  document.addEventListener("DOMContentLoaded", function () {
    const ctx = document.getElementById("myChart").getContext("2d");
    const viw_error = document.getElementById("view-error");

    const labels = JSON.parse("{{ labels|escapejs }}");
    const countData = JSON.parse("{{ countData|escapejs }}");
    let backgroundColors = generateRandomColors(countData.length);

    if (countData.every((v) => v == 0) == true) {
      viw_error.id = "";
      viw_error.style.display = "visible";
      viw_error.style.textAlign = "center";
      viw_error.style.marginTop = "-100px";
      viw_error.innerHTML = "Zero Clicks on the Personal Url.";
      return;
    }

    const config = {
      type: "doughnut",
      data: {
        labels: labels,
        datasets: [
          {
            label: "Users Click Count",
            data: countData,
            backgroundColor: backgroundColors,

            hoverOffset: 4,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
      },
    };

    new Chart(ctx, config);
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

{% endblock content %}
